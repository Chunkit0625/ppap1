<!doctype html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>PayPal — High-Fidelity Demo</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <style>
    /* 保持之前的CSS样式不变 */
    :root {
      --pp-bg: #f5f7fa;
      --pp-navy: #001435;
      --pp-blue: #0070ba;
      --pp-blue-dark: #003087;
      --pp-muted: #6b7280;
      --pp-card: #ffffff;
      --pp-success: #22c55e;
      --pp-radius-lg: 18px;
      --pp-radius-xl: 22px;
      --pp-shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.09);
      --pp-shadow-card: 0 12px 32px rgba(15, 23, 42, 0.06);
    }

    body {
      background: radial-gradient(circle at top, #e5f1ff 0, #f5f7fa 42%, #edf1f7 100%);
      -webkit-font-smoothing: antialiased;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Inter", "Segoe UI", sans-serif;
      /* 确保body有足够的内边距来容纳底部导航 */
      padding-bottom: calc(80px + env(safe-area-inset-bottom, 0px));
    }

    .pp-page {
      opacity: 0;
      transform: translateY(8px);
      pointer-events: none;
      transition: all 0.3s ease;
    }

    .pp-page-active {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .hidden {
      display: none !important;
    }

    .pp-card-balance {
      margin-top: 1rem;
      border-radius: 24px;
      background: radial-gradient(circle at top left, #e6f3ff 0, #ffffff 40%, #f8fafc 100%);
      box-shadow: var(--pp-shadow-soft);
      border: 1px solid rgba(15, 23, 42, 0.05);
      padding: 1.2rem 1.3rem 1.1rem;
      backdrop-filter: blur(16px);
    }

    .pp-primary-btn {
      border-radius: 999px;
      background: linear-gradient(135deg, #0070ba, #004b90);
      color: white;
      padding: 0.65rem 1rem;
      box-shadow: 0 14px 32px rgba(0, 112, 186, 0.35);
      border: none;
      outline: none;
      transition: transform 0.13s ease, box-shadow 0.13s ease, background 0.13s ease;
      cursor: pointer;
    }

    .pp-primary-btn:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 6px 18px rgba(0, 112, 186, 0.5);
    }

    .pp-primary-btn:disabled {
      opacity: 0.55;
      box-shadow: none;
      cursor: default;
    }

    .pp-secondary-btn {
      border-radius: 999px;
      background: #ffffff;
      color: #111827;
      padding: 0.6rem 1rem;
      border: 1px solid rgba(148, 163, 184, 0.45);
      box-shadow: 0 10px 26px rgba(15, 23, 42, 0.04);
      transition: transform 0.13s ease, box-shadow 0.13s ease, background 0.13s ease, border-color 0.13s ease;
      cursor: pointer;
    }

    .pp-secondary-btn:hover {
      background: #f9fafb;
    }

    .pp-secondary-btn:active {
      transform: translateY(1px);
      box-shadow: 0 4px 14px rgba(15, 23, 42, 0.08);
    }

    .pp-quick-actions {
      border-radius: 18px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 16px 40px rgba(15, 23, 42, 0.06);
      padding: 0.9rem 1rem 1rem;
      border: 1px solid rgba(148, 163, 184, 0.25);
      backdrop-filter: blur(18px);
    }

    .pp-action-tile {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      gap: 0.4rem;
      padding: 0.6rem 0.3rem;
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      background: radial-gradient(circle at top, rgba(191, 219, 254, 0.22), rgba(255, 255, 255, 0.98));
      color: #0f172a;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      box-shadow: 0 10px 26px rgba(15, 23, 42, 0.05);
      transition: transform 0.11s ease, box-shadow 0.11s ease, border-color 0.11s ease, background 0.11s ease;
      cursor: pointer;
      border: none;
    }

    .pp-action-tile:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 36px rgba(15, 23, 42, 0.1);
      border-color: rgba(37, 99, 235, 0.5);
    }

    .pp-action-tile:active {
      transform: translateY(0);
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.14);
    }

    .pp-action-icon {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: linear-gradient(135deg, #eff6ff, #dbeafe);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #1d4ed8;
    }

    .pp-card-section {
      background: rgba(255, 255, 255, 0.98);
      border-radius: var(--pp-radius-xl);
      padding: 1.1rem 1.1rem 1.2rem;
      border: 1px solid rgba(148, 163, 184, 0.28);
      box-shadow: var(--pp-shadow-card);
    }

    .pp-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-weight: 600;
      color: #6b7280;
    }

    .pp-input {
      width: 100%;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: radial-gradient(circle at top, #f9fafb, #ffffff);
      padding: 0.6rem 0.9rem;
      font-size: 14px;
      outline: none;
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.7), 0 6px 18px rgba(15, 23, 42, 0.03);
      transition: border-color 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    .pp-input::placeholder {
      color: #9ca3af;
    }

    .pp-input:focus {
      border-color: #0ea5e9;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4), 0 10px 30px rgba(15, 23, 42, 0.06);
      background: #ffffff;
    }

    .pp-amount-display {
      font-size: 2.75rem;
      line-height: 1;
      font-weight: 800;
      letter-spacing: -0.04em;
      color: var(--pp-navy);
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      background: radial-gradient(circle at top, #e0f2fe, #f9fafb);
      box-shadow: inset 0 0 0 1px rgba(148, 163, 184, 0.35), 0 16px 40px rgba(15, 23, 42, 0.08);
      min-width: 8rem;
      text-align: center;
    }

    .pp-numpad {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.6rem;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 0.8rem;
      box-shadow: 0 18px 42px rgba(15, 23, 42, 0.08);
      border: 1px solid rgba(148, 163, 184, 0.24);
    }

    .pp-key {
      background: #ffffff;
      border-radius: 999px;
      padding: 0.7rem 0;
      font-size: 1.1rem;
      font-weight: 700;
      text-align: center;
      color: #111827;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.06);
      border: 1px solid rgba(229, 231, 235, 0.9);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.08s ease, border-color 0.08s ease;
      border: none;
    }

    .pp-key:hover {
      background: #f9fafb;
    }

    .pp-key:active {
      transform: translateY(1px);
      box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12);
    }

    .pp-key-secondary {
      background: linear-gradient(135deg, #f3f4f6, #ffffff);
      color: #6b7280;
    }

    .pp-review-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.25rem 0;
    }

    .pp-review-label {
      font-size: 12px;
      color: #6b7280;
    }

    .pp-review-value {
      font-size: 13px;
      color: var(--pp-navy);
      font-weight: 600;
    }

    .pp-back-btn {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: #ffffff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #0f172a;
      box-shadow: 0 8px 22px rgba(15, 23, 42, 0.08);
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
      cursor: pointer;
      border: none;
    }

    .pp-back-btn:active {
      transform: translateY(1px);
      box-shadow: 0 3px 10px rgba(15, 23, 42, 0.14);
    }

    .pp-success-wrap {
      margin-top: 0.5rem;
      padding: 1.6rem 1.1rem 1.4rem;
      border-radius: 24px;
      background: radial-gradient(circle at top, #dcfce7, #ecfdf5 40%, #f9fafb 100%);
      box-shadow: 0 20px 50px rgba(22, 163, 74, 0.16);
      border: 1px solid rgba(22, 163, 74, 0.35);
      text-align: center;
    }

    .pp-success-check {
      width: 140px;
      height: 140px;
      border-radius: 999px;
      margin: 0 auto;
      background: conic-gradient(from 210deg, #16a34a, #22c55e, #4ade80, #16a34a);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      box-shadow: 0 24px 60px rgba(22, 163, 74, 0.36);
      transform: scale(0);
    }

    .pp-success-title {
      margin-top: 1.1rem;
      font-size: 1.05rem;
      font-weight: 800;
      color: var(--pp-navy);
    }

    .pp-success-subtitle {
      margin-top: 0.4rem;
      font-size: 0.9rem;
      color: #4b5563;
    }

    .pp-bottom-nav {
      position: fixed;
      inset-inline: 0;
      bottom: 0;
      padding-bottom: env(safe-area-inset-bottom, 0px);
      padding-top: 0.25rem;
      background: linear-gradient(to top, rgba(15, 23, 42, 0.22), transparent);
      pointer-events: none;
      z-index: 1000; /* 确保导航在最上层 */
    }

    .pp-bottom-nav-inner {
      max-width: 420px;
      margin: 0 auto 0.75rem;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 999px;
      padding: 0.3rem 0.6rem;
      display: flex;
      justify-content: space-between;
      gap: 0.2rem;
      box-shadow: 0 22px 50px rgba(15, 23, 42, 0.5);
      pointer-events: auto;
      /* 确保导航栏在安全区域内 */
      margin-bottom: max(0.75rem, env(safe-area-inset-bottom, 0px));
    }

    .pp-nav-item {
      flex: 1;
      min-width: 0;
      border-radius: 999px;
      padding: 0.35rem 0.3rem;
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.12rem;
      font-size: 11px;
      color: rgba(226, 232, 240, 0.7);
      font-weight: 500;
      transition: color 0.12s ease, background 0.12s ease, transform 0.12s ease;
      cursor: pointer;
      border: none;
      background: transparent;
    }

    .pp-nav-item i {
      opacity: 0.85;
    }

    .pp-nav-item-active {
      background: radial-gradient(circle at top, rgba(96, 165, 250, 0.7), rgba(37, 99, 235, 0.9));
      color: white;
      transform: translateY(-1px);
    }

    .pp-nav-item-active i {
      opacity: 1;
    }

    .pp-tx-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.65rem 0.85rem;
      border-bottom: 1px solid rgba(226, 232, 240, 0.9);
    }

    .pp-tx-row:last-child {
      border-bottom: none;
    }

    .pp-tx-meta {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .pp-tx-avatar {
      width: 38px;
      height: 38px;
      border-radius: 999px;
      background: radial-gradient(circle at top, #e5e7eb, #f9fafb);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #111827;
      font-size: 13px;
      font-weight: 700;
      box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.02);
    }

    .pp-tx-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--pp-navy);
    }

    .pp-tx-sub {
      font-size: 11px;
      color: #6b7280;
    }

    .pp-tx-amount {
      font-size: 13px;
      font-weight: 700;
      color: var(--pp-navy);
    }

    .pp-tx-amount-negative {
      color: #b91c1c;
    }

    .pp-tx-amount-positive {
      color: #166534;
    }

    .pp-empty {
      padding: 0.85rem 0.85rem 0.95rem;
      text-align: center;
      font-size: 12px;
      color: #6b7280;
    }

    @media (max-width: 420px) {
      .pp-card-balance {
        border-radius: 22px;
      }

      .pp-success-check {
        width: 120px;
        height: 120px;
      }

      .pp-amount-display {
        font-size: 2.35rem;
      }
      
      /* 在小屏幕上调整底部导航 */
      .pp-bottom-nav-inner {
        margin: 0 1rem 0.75rem;
        margin-bottom: max(0.75rem, env(safe-area-inset-bottom, 0px));
      }
    }
    
    /* 针对非常小的屏幕进一步调整 */
    @media (max-width: 360px) {
      .pp-bottom-nav-inner {
        margin: 0 0.5rem 0.75rem;
        margin-bottom: max(0.75rem, env(safe-area-inset-bottom, 0px));
        padding: 0.25rem 0.5rem;
      }
      
      .pp-nav-item {
        font-size: 10px;
        padding: 0.3rem 0.2rem;
      }
    }
  </style>
</head>
<body class="h-full bg-slate-50 antialiased">
  <div class="min-h-full flex flex-col">
    <header class="bg-[#003087] text-white">
      <div class="mx-auto max-w-md px-4 pt-3 pb-4 flex items-center justify-between">
        <button class="inline-flex items-center gap-2 text-sm font-medium tracking-tight">
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-white/10">
            <i data-lucide="menu" class="w-4 h-4"></i>
          </span>
          <span class="uppercase text-[11px] tracking-[0.18em] opacity-80">PayPal</span>
        </button>
        <div class="inline-flex items-center gap-2 text-xs">
          <span class="opacity-80 hidden sm:inline">Security</span>
          <span class="w-[1px] h-5 bg-white/20 hidden sm:inline"></span>
          <button class="px-3 py-1 rounded-full bg-white/10 text-[11px] font-medium hover:bg-white/15 transition">
            Log out
          </button>
        </div>
      </div>
      <div class="mx-auto max-w-md px-4 pb-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div id="avatar" class="w-10 h-10 rounded-full bg-gradient-to-br from-sky-50 to-blue-100 flex items-center justify-center text-[#001435] text-sm font-semibold shadow-sm">
              DU
            </div>
            <div>
              <p class="text-xs font-medium tracking-wide uppercase opacity-80">Good afternoon</p>
              <p id="userDisplayName" class="text-sm font-semibold leading-tight">Chunkit</p>
              <p id="userDisplayEmail" class="text-[11px] opacity-80">Chunkitstarnui@gmail.com</p>
            </div>
          </div>
          <button class="relative inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/10 hover:bg-white/20 transition">
            <i data-lucide="bell" class="w-4 h-4"></i>
            <span class="absolute -top-1 -right-0.5 w-4 h-4 rounded-full bg-[#0070BA] text-[9px] flex items-center justify-center font-semibold border border-[#003087]">
              3
            </span>
          </button>
        </div>
      </div>
    </header>

    <main class="flex-1">
      <div class="mx-auto max-w-md px-4 -mt-6 pb-24">
        <!-- Dashboard Screen -->
        <section id="dashboard" class="pp-page pp-page-active">
          <div class="pp-card-balance">
            <div class="flex items-start justify-between">
              <div>
                <p class="text-[11px] font-medium tracking-[0.16em] uppercase text-slate-500">
                  PayPal balance
                </p>
                <p id="balance" class="mt-1 text-3xl font-extrabold tracking-tight text-[#001435]">
                  $8,800,000.00
                </p>
                <p class="mt-0.5 text-xs font-semibold text-[#0070BA] uppercase tracking-[0.14em]">
                  Available
                </p>
              </div>
              <div class="text-right text-xs text-slate-500">
                <p class="font-medium">Primary currency</p>
                <p class="mt-0.5 text-[11px]">USD - U.S. Dollar</p>
              </div>
            </div>
            <div class="mt-4 flex gap-2">
              <button id="primarySend" class="pp-primary-btn flex-1 inline-flex items-center justify-center gap-2">
                <i data-lucide="send" class="w-3.5 h-3.5 -rotate-45"></i>
                <span class="text-sm font-semibold">Send</span>
              </button>
              <button class="pp-secondary-btn flex-1 inline-flex items-center justify-center gap-2">
                <i data-lucide="corner-down-left" class="w-3.5 h-3.5"></i>
                <span class="text-sm font-semibold">Request</span>
              </button>
            </div>
            <div class="mt-3 flex items-center justify-between text-[11px] text-slate-500">
              <div class="inline-flex items-center gap-1">
                <i data-lucide="shield-check" class="w-3.5 h-3.5"></i>
                <span>Eligible for Buyer Protection</span>
              </div>
              <button class="underline-offset-2 hover:underline">Details</button>
            </div>
          </div>

          <section class="mt-4 pp-quick-actions">
            <div class="flex items-center justify-between mb-1.5">
              <p class="text-xs font-semibold text-slate-700 uppercase tracking-[0.14em]">
                Quick actions
              </p>
            </div>
            <div class="grid grid-cols-4 gap-2">
              <button class="pp-action-tile" id="actionSend">
                <div class="pp-action-icon">
                  <i data-lucide="send" class="w-3.5 h-3.5 -rotate-45"></i>
                </div>
                <span>Send</span>
              </button>
              <button class="pp-action-tile">
                <div class="pp-action-icon">
                  <i data-lucide="corner-down-left" class="w-3.5 h-3.5"></i>
                </div>
                <span>Request</span>
              </button>
              <button class="pp-action-tile">
                <div class="pp-action-icon">
                  <i data-lucide="credit-card" class="w-3.5 h-3.5"></i>
                </div>
                <span>Wallet</span>
              </button>
              <button class="pp-action-tile">
                <div class="pp-action-icon">
                  <i data-lucide="repeat" class="w-3.5 h-3.5"></i>
                </div>
                <span>Activity</span>
              </button>
            </div>
          </section>

          <section class="mt-5">
            <div class="flex items-center justify-between mb-2">
              <h2 class="text-sm font-semibold text-[#001435]">
                Recent activity
              </h2>
              <button class="text-xs font-medium text-[#0070BA] hover:underline">
                View all
              </button>
            </div>
            <div class="rounded-2xl bg-white/80 shadow-sm ring-1 ring-slate-100 overflow-hidden">
              <div id="txList">
                <!-- Transactions will be populated by JavaScript -->
              </div>
            </div>
          </section>
        </section>

        <!-- Send Money Screen -->
        <section id="send" class="pp-page hidden">
          <div class="flex items-center gap-3 py-3">
            <button data-nav-target="dashboard" class="pp-back-btn">
              <i data-lucide="chevron-left" class="w-4 h-4"></i>
            </button>
            <div>
              <p class="text-xs uppercase tracking-[0.16em] text-slate-500 font-medium">
                Send and Request
              </p>
              <p class="text-sm font-semibold text-[#001435] leading-tight">
                Send money
              </p>
            </div>
          </div>

          <div class="pp-card-section mt-1">
            <div class="mb-3">
              <label for="recipient" class="pp-label">Send to</label>
              <div class="relative mt-1.5">
                <input id="recipient" class="pp-input pr-9" placeholder="Name, @username, email or mobile" autocomplete="off">
                <div class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400">
                  <i data-lucide="search" class="w-4 h-4"></i>
                </div>
              </div>
              <p class="mt-1 text-[11px] text-slate-500">
                We'll never share your email or phone with the recipient.
              </p>
            </div>
            <div class="mt-4">
              <label class="pp-label">Amount</label>
              <div class="mt-1 flex flex-col items-center justify-center">
                <div id="moneyDisplay" class="pp-amount-display">
                  $0.00
                </div>
                <p class="mt-1.5 text-[11px] text-slate-500">
                  Available: <span id="availableBalanceSmall" class="font-medium">$8,800,000.00</span> USD
                </p>
              </div>
            </div>
          </div>

          <div class="mt-4">
            <div class="pp-numpad" id="numpad"></div>
            <p class="mt-2 text-[11px] text-center text-slate-500">
              Tap to enter amount. We'll convert to your recipient's currency when needed.
            </p>
          </div>

          <div class="mt-5">
            <button id="toReview" class="pp-primary-btn w-full flex items-center justify-center gap-2">
              <span class="text-sm font-semibold">Continue</span>
              <i data-lucide="chevron-right" class="w-4 h-4"></i>
            </button>
          </div>
        </section>

        <!-- Review Screen -->
        <section id="review" class="pp-page hidden">
          <div class="flex items-center gap-3 py-3">
            <button data-nav-target="send" class="pp-back-btn">
              <i data-lucide="chevron-left" class="w-4 h-4"></i>
            </button>
            <div>
              <p class="text-xs uppercase tracking-[0.16em] text-slate-500 font-medium">
                Review and send
              </p>
              <p class="text-sm font-semibold text-[#001435] leading-tight">
                Confirm payment
              </p>
            </div>
          </div>

          <div class="pp-card-section mt-1">
            <div class="flex items-center justify-between mb-4">
              <div>
                <p class="pp-label mb-0.5">You're sending to</p>
                <p id="rRecipient" class="text-sm font-semibold text-[#001435]">
                  —
                </p>
              </div>
              <div class="flex items-center gap-2 text-[11px] text-slate-500">
                <i data-lucide="user" class="w-3.5 h-3.5"></i>
                <span>Personal payment</span>
              </div>
            </div>

            <div class="border-t border-slate-100 pt-3 space-y-2">
              <div class="pp-review-row">
                <span class="pp-review-label">You send</span>
                <span id="rAmount" class="pp-review-value">$0.00</span>
              </div>
              <div class="pp-review-row">
                <span class="pp-review-label">Pay with</span>
                <span class="pp-review-value">PayPal balance</span>
              </div>
              <div class="pp-review-row">
                <span class="pp-review-label">Fee</span>
                <span class="pp-review-value text-emerald-600">No fee</span>
              </div>
              <div class="pp-review-row border-t border-dashed border-slate-200 pt-2 mt-1">
                <span class="pp-review-label font-semibold text-[#001435]">Total</span>
                <span id="rTotal" class="pp-review-value font-semibold">$0.00</span>
              </div>
            </div>

            <p class="mt-3 text-[11px] text-slate-500">
              By clicking <span class="font-semibold">Send now</span>, you agree to the PayPal User Agreement,
              including payment terms and applicable fees.
            </p>
          </div>

          <div class="mt-5 space-y-2">
            <button id="sendNow" class="pp-primary-btn w-full flex items-center justify-center gap-2">
              <span class="text-sm font-semibold">Send now</span>
              <i data-lucide="shield-check" class="w-4 h-4"></i>
            </button>
            <button data-nav-target="send" class="pp-secondary-btn w-full text-sm font-medium">
              Change details
            </button>
          </div>
        </section>

        <!-- Success Screen -->
        <section id="success" class="pp-page hidden">
          <div class="flex items-center gap-3 py-3">
            <button data-nav-target="dashboard" class="pp-back-btn">
              <i data-lucide="chevron-left" class="w-4 h-4"></i>
            </button>
            <div>
              <p class="text-xs uppercase tracking-[0.16em] text-slate-500 font-medium">
                Payment sent
              </p>
              <p class="text-sm font-semibold text-[#001435] leading-tight">
                You're all set
              </p>
            </div>
          </div>

          <div class="pp-success-wrap">
            <div id="successCheck" class="pp-success-check">
              <i data-lucide="check" class="w-10 h-10"></i>
            </div>
            <p id="sentText" class="pp-success-title">
              You sent $0.00
            </p>
            <p id="sentSub" class="pp-success-subtitle">
              to someone
            </p>
            <div class="mt-4 text-[11px] text-slate-500">
              <p>We've emailed your recipient the details of this transaction.</p>
              <p class="mt-1">You can view this payment anytime in your Activity.</p>
            </div>
          </div>

          <div class="mt-5 space-y-2">
            <button data-nav-target="dashboard" class="pp-primary-btn w-full">
              Back to summary
            </button>
            <button class="pp-secondary-btn w-full text-sm font-medium">
              View activity
            </button>
          </div>
        </section>
      </div>
    </main>

    <nav class="pp-bottom-nav">
      <div class="pp-bottom-nav-inner">
        <button class="pp-nav-item pp-nav-item-active" data-nav-main="dashboard">
          <i data-lucide="home" class="w-4 h-4"></i>
          <span>Home</span>
        </button>
        <button class="pp-nav-item">
          <i data-lucide="wallet" class="w-4 h-4"></i>
          <span>Wallet</span>
        </button>
        <button class="pp-nav-item">
          <i data-lucide="activity" class="w-4 h-4"></i>
          <span>Activity</span>
        </button>
        <button class="pp-nav-item">
          <i data-lucide="user" class="w-4 h-4"></i>
          <span>Settings</span>
        </button>
      </div>
    </nav>
  </div>

  <script>
    // 将所有JavaScript代码整合到这里
    const STORAGE_KEY = "mock_paypal_demo";
    const INITIAL_BALANCE = 8800000.00;

    const DEFAULT_STATE = {
      user: { name: "Chunkit", email: "Chunkitstarnui@gmail.com" },
      balance: INITIAL_BALANCE,
      transactions: [
        {
          id: Date.now() - 300000,
          title: "Acme Corp",
          date: "Nov 12 • Completed",
          amount: -420.0,
          type: "payment"
        },
        {
          id: Date.now() - 200000,
          title: "PayPal Pte Ltd",
          date: "Nov 01 • Money received",
          amount: 5000.0,
          type: "receive"
        },
        {
          id: Date.now() - 100000,
          title: "Coffee Shop",
          date: "Oct 30 • Card payment",
          amount: -5.75,
          type: "payment"
        }
      ]
    };

    // App state
    let state = loadState();
    let currentAmount = "0"; // 默认金额为0
    let pending = null;

    function loadState() {
      try {
        const raw = window.localStorage.getItem(STORAGE_KEY);
        if (!raw) {
          const clone = JSON.parse(JSON.stringify(DEFAULT_STATE));
          window.localStorage.setItem(STORAGE_KEY, JSON.stringify(clone));
          return clone;
        }
        const parsed = JSON.parse(raw);
        if (typeof parsed.balance !== "number") parsed.balance = DEFAULT_STATE.balance;
        if (!Array.isArray(parsed.transactions)) parsed.transactions = DEFAULT_STATE.transactions;
        if (!parsed.user) parsed.user = DEFAULT_STATE.user;
        return parsed;
      } catch (e) {
        const clone = JSON.parse(JSON.stringify(DEFAULT_STATE));
        window.localStorage.setItem(STORAGE_KEY, JSON.stringify(clone));
        return clone;
      }
    }

    function saveState(state) {
      window.localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function formatCurrency(v) {
      return new Intl.NumberFormat("en-US", {
        style: "currency",
        currency: "USD",
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      }).format(v);
    }

    function escapeHtml(s) {
      const map = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
      };
      return String(s).replace(new RegExp("[&<>\"']", "g"), c => map[c]);
    }

    function extractInitials(name) {
      if (!name) return "PP";
      return name
        .split(" ")
        .filter(Boolean)
        .map(p => p[0])
        .slice(0, 2)
        .join("")
        .toUpperCase();
    }

    function initIcons() {
      if (window.lucide && typeof window.lucide.createIcons === "function") {
        window.lucide.createIcons();
      }
    }

    function animatePageEnter(id) {
      const page = document.getElementById(id);
      if (!page || !window.gsap) return;
      window.gsap.fromTo(
        page,
        { y: 12, opacity: 0 },
        { y: 0, opacity: 1, duration: 0.24, ease: "power2.out" }
      );
    }

    function renderDashboard(state) {
      const balanceEl = document.getElementById("balance");
      const avatarEl = document.getElementById("avatar");
      const nameEl = document.getElementById("userDisplayName");
      const emailEl = document.getElementById("userDisplayEmail");
      const availSmall = document.getElementById("availableBalanceSmall");

      if (balanceEl) balanceEl.textContent = formatCurrency(state.balance);
      if (availSmall) availSmall.textContent = formatCurrency(state.balance);
      if (avatarEl) avatarEl.textContent = extractInitials(state.user.name);
      if (nameEl) nameEl.textContent = state.user.name;
      if (emailEl) emailEl.textContent = state.user.email;

      renderTxList(state.transactions);
    }

    function renderTxList(transactions) {
      const list = document.getElementById("txList");
      if (!list) return;
      list.innerHTML = "";

      if (!transactions || !transactions.length) {
        const empty = document.createElement("div");
        empty.className = "pp-empty";
        empty.textContent = "No recent activity. Payments you send or receive will appear here.";
        list.appendChild(empty);
        return;
      }

      transactions.forEach(tx => {
        const row = document.createElement("div");
        row.className = "pp-tx-row";

        const meta = document.createElement("div");
        meta.className = "pp-tx-meta";

        const avatar = document.createElement("div");
        avatar.className = "pp-tx-avatar";
        avatar.textContent = extractInitials(tx.title || "PP");

        const textWrap = document.createElement("div");
        const title = document.createElement("div");
        title.className = "pp-tx-title";
        title.textContent = tx.title;

        const sub = document.createElement("div");
        sub.className = "pp-tx-sub";
        sub.textContent = tx.date || "";

        textWrap.appendChild(title);
        textWrap.appendChild(sub);

        meta.appendChild(avatar);
        meta.appendChild(textWrap);

        const amt = document.createElement("div");
        const isPositive = tx.amount >= 0;
        const sign = isPositive ? "+" : "";
        amt.className =
          "pp-tx-amount " +
          (isPositive ? "pp-tx-amount-positive" : "pp-tx-amount-negative");
        amt.textContent =
          sign + formatCurrency(Math.abs(tx.amount)).replace("$", "");

        row.appendChild(meta);
        row.appendChild(amt);

        list.appendChild(row);
      });
    }

    function buildNumpad(onKey) {
      const pad = document.getElementById("numpad");
      if (!pad) return;
      const keys = ["1", "2", "3", "4", "5", "6", "7", "8", "9", ".", "0", "←"];
      pad.innerHTML = "";
      keys.forEach(key => {
        const el = document.createElement("button");
        el.type = "button";
        el.className = "pp-key" + (key === "←" ? " pp-key-secondary" : "");
        el.textContent = key;
        el.addEventListener("click", () => onKey(key));
        pad.appendChild(el);
      });
    }

    function updateAmountDisplay(str) {
      const display = document.getElementById("moneyDisplay");
      if (!display) return;
      display.textContent = "$" + formatNumberWithCommas(str);
    }

    function showPage(id) {
      const pages = document.querySelectorAll(".pp-page");
      pages.forEach(p => {
        if (p.id === id) {
          p.classList.remove("hidden");
          p.classList.add("pp-page-active");
        } else {
          p.classList.add("hidden");
          p.classList.remove("pp-page-active");
        }
      });
      animatePageEnter(id);
    }

    function successAnimation() {
      const el = document.getElementById("successCheck");
      if (!el || !window.gsap) return;
      window.gsap.fromTo(
        el,
        { scale: 0 },
        { scale: 1, duration: 0.45, ease: "back.out(2)" }
      );
    }

    function playSuccessSound() {
      try {
        const Ctx = window.AudioContext || window.webkitAudioContext;
        if (!Ctx) return;
        const ctx = new Ctx();
        const now = ctx.currentTime;

        const o1 = ctx.createOscillator();
        const g1 = ctx.createGain();
        o1.type = "sine";
        o1.frequency.value = 880;
        g1.gain.value = 0.0001;
        o1.connect(g1);
        g1.connect(ctx.destination);
        g1.gain.setValueAtTime(0.0001, now);
        g1.gain.exponentialRampToValueAtTime(0.14, now + 0.02);
        g1.gain.exponentialRampToValueAtTime(0.0001, now + 0.36);
        o1.start(now);
        o1.stop(now + 0.38);

        const o2 = ctx.createOscillator();
        const g2 = ctx.createGain();
        o2.type = "sine";
        o2.frequency.value = 1320;
        o2.connect(g2);
        g2.connect(ctx.destination);
        g2.gain.setValueAtTime(0.0001, now + 0.06);
        g2.gain.exponentialRampToValueAtTime(0.1, now + 0.09);
        g2.gain.exponentialRampToValueAtTime(0.0001, now + 0.42);
        o2.start(now + 0.06);
        o2.stop(now + 0.44);
      } catch (e) {}
    }

    function updateSuccessCopy(amount, recipient) {
      const sentText = document.getElementById("sentText");
      const sentSub = document.getElementById("sentSub");
      if (sentText) sentText.textContent = "You sent " + formatCurrency(amount);
      if (sentSub) sentSub.textContent = "to " + escapeHtml(recipient);
    }

    function formatNumberWithCommas(v) {
      const s = String(v);
      if (s.indexOf(".") !== -1) {
        const parts = s.split(".");
        return (
          numberWithCommas(parts[0]) +
          (parts[1] ? "." + parts[1].slice(0, 2) : "")
        );
      }
      return numberWithCommas(s);
    }

    function numberWithCommas(x) {
      if (x === "") return "0";
      const n = Number(x);
      if (Number.isNaN(n)) return x;
      return n.toLocaleString("en-US");
    }

    function init() {
      initIcons();
      renderDashboard(state);
      buildNumpad(handleNumKey);
      updateAmountDisplay(currentAmount);
      bindEvents();
      setupKeyboard();
    }

    function bindEvents() {
      const primarySend = document.getElementById("primarySend");
      const actionSend = document.getElementById("actionSend");
      if (primarySend) primarySend.addEventListener("click", () => goSend());
      if (actionSend) actionSend.addEventListener("click", () => goSend());

      document.querySelectorAll("[data-nav-target]").forEach(btn => {
        btn.addEventListener("click", () => {
          const target = btn.getAttribute("data-nav-target");
          if (target === "dashboard") {
            renderDashboard(state);
          }
          showPage(target);
          initIcons();
        });
      });

      document.querySelectorAll("[data-nav-main]").forEach(btn => {
        btn.addEventListener("click", () => {
          const target = btn.getAttribute("data-nav-main");
          setActiveNav(btn);
          if (target === "dashboard") {
            renderDashboard(state);
          }
          showPage(target);
          initIcons();
        });
      });

      const toReview = document.getElementById("toReview");
      if (toReview) toReview.addEventListener("click", onReview);

      const sendNow = document.getElementById("sendNow");
      if (sendNow) sendNow.addEventListener("click", onSendNow);

      // 修复：recipient输入框不修改金额
      const recipientInput = document.getElementById("recipient");
      if (recipientInput) {
        recipientInput.addEventListener("input", function() {
          // 这里不执行任何金额更新操作
          console.log("Recipient input changed, but amount remains unchanged");
        });
      }
    }

    function setActiveNav(activeBtn) {
      document.querySelectorAll(".pp-nav-item").forEach(btn => {
        if (btn === activeBtn) btn.classList.add("pp-nav-item-active");
        else btn.classList.remove("pp-nav-item-active");
      });
    }

    function goSend() {
      // 设置默认金额为0
      currentAmount = "0";
      updateAmountDisplay(currentAmount);
      const recipient = document.getElementById("recipient");
      if (recipient) recipient.value = "";
      showPage("send");
      initIcons();
    }

    function handleNumKey(k) {
      if (k === "←") {
        if (currentAmount.length <= 1) currentAmount = "0";
        else currentAmount = currentAmount.slice(0, -1);
      } else {
        if (k === "." && currentAmount.indexOf(".") !== -1) {
          return;
        }
        if (currentAmount === "0" && k !== ".") {
          currentAmount = k;
        } else {
          currentAmount += k;
        }
      }

      if (currentAmount.indexOf(".") !== -1) {
        const parts = currentAmount.split(".");
        parts[1] = (parts[1] || "").slice(0, 2);
        currentAmount = parts[0] + (parts[1] ? "." + parts[1] : "");
      }

      if (!currentAmount.includes(".") && currentAmount.length > 1 && currentAmount.startsWith("0")) {
        currentAmount = String(Number(currentAmount));
      }

      if (currentAmount === "") currentAmount = "0";
      updateAmountDisplay(currentAmount);
    }

    function onReview() {
      const amountNum = parseFloat(currentAmount.replace(new RegExp(",", "g"), ""));
      if (!amountNum || amountNum <= 0) {
        window.alert("Please enter a valid amount greater than 0.");
        return;
      }
      if (amountNum > state.balance) {
        window.alert("Insufficient funds in your PayPal balance.");
        return;
      }
      const recipientInput = document.getElementById("recipient");
      const recipient = recipientInput && recipientInput.value.trim().length
        ? recipientInput.value.trim()
        : "Unknown";

      const rRecipient = document.getElementById("rRecipient");
      const rAmount = document.getElementById("rAmount");
      const rTotal = document.getElementById("rTotal");
      if (rRecipient) rRecipient.textContent = recipient;
      if (rAmount) rAmount.textContent = formatCurrency(amountNum);
      if (rTotal) rTotal.textContent = formatCurrency(amountNum);

      pending = { amount: amountNum, recipient };
      showPage("review");
      initIcons();
    }

    function onSendNow() {
      if (!pending) {
        window.alert("Nothing to send.");
        return;
      }
      if (pending.amount > state.balance) {
        window.alert("Insufficient funds in your PayPal balance.");
        return;
      }

      state.balance = +(state.balance - pending.amount).toFixed(2);
      const tx = {
        id: Date.now(),
        title: pending.recipient,
        date: "Just now • Completed",
        amount: -pending.amount,
        type: "send"
      };
      state.transactions.unshift(tx);
      saveState(state);

      updateSuccessCopy(pending.amount, pending.recipient);
      showPage("success");
      initIcons();
      successAnimation();
      playSuccessSound();

      pending = null;
    }

    function setupKeyboard() {
      window.addEventListener("keydown", e => {
        const sendPage = document.getElementById("send");
        if (!sendPage || sendPage.classList.contains("hidden")) return;
        if (e.key >= "0" && e.key <= "9") handleNumKey(e.key);
        if (e.key === ".") handleNumKey(".");
        if (e.key === "Backspace") handleNumKey("←");
        if (e.key === "Enter") {
          const toReview = document.getElementById("toReview");
          if (toReview) toReview.click();
        }
      });
    }

    // Initialize the app
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>